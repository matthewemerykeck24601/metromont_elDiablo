[build]
  command = "node netlify/generate-env.js"
  publish = "."

# DB API Function Routes
[[redirects]]
  from = "/api/db/health"
  to = "/.netlify/functions/db-health"
  status = 200

[[redirects]]
  from = "/api/db/objects"
  to = "/.netlify/functions/db-objects"
  status = 200

[[redirects]]
  from = "/api/db/folders"
  to = "/.netlify/functions/db-folders"
  status = 200

[[redirects]]
  from = "/api/db/folders/*"
  to = "/.netlify/functions/db-folders"
  status = 200

[[redirects]]
  from = "/api/db/tables"
  to = "/.netlify/functions/db-tables"
  status = 200

[[redirects]]
  from = "/api/db/rows/:tableId/:rowId"
  to = "/.netlify/functions/db-rows"
  status = 200

[[redirects]]
  from = "/api/db/rows/:tableId"
  to = "/.netlify/functions/db-rows"
  status = 200

[[redirects]]
  from = "/api/ai/health"
  to = "/.netlify/functions/ai-health"
  status = 200

[[redirects]]
  from = "/api/ai"
  to = "/.netlify/functions/ai-router"
  status = 200

# Legacy redirect for backward compatibility (old AI DB endpoint)
[[redirects]]
  from = "/api/ai/db"
  to = "/.netlify/functions/ai-router"
  status = 200

[[redirects]]
  from = "/api/admin/roles"
  to = "/.netlify/functions/admin-roles"
  status = 200